

#第二部分 游戏逻辑


##战斗计算【最重要】
为了方便数值策划调试数值，【必须】单独书写一个调试接口，供数值模拟演算战斗情况。


##场景同步【最吃资源】

战斗，移动同步
场景网格划分。（在场景元素管理中，用四叉树取代现在的链表结构，场景网格结构，早就过时了，现在2d普遍用四叉树，3d用八叉树）




##怪物AI【耗资源】
怪物的AI是靠定时器即使刷新的，以便根据自身的情况即使改变自己的状态，比如是巡逻、攻击、追击、返回等，几乎一款游戏有很多的怪物，怪物的行为不一值，所以需要添加的定时器也很多；我们优化的方向是当怪物巡逻时，我们将定时器的间隔设置的长一些，当怪物收到攻击之后，我们将怪物AI的定时器设置的短些。

一个怪物如果不在任何一个玩家的视野内，其应该是不占用任何AI资源的。也就是AI由它第一次进入玩家视野的时候触发,如果它离开了所有玩家的视野，AI应该被终止，这样可以节省很多无谓的AI资源消耗。

把AI独立服务器的处理方法大致上如下
当需要AOI广播的时候，把Monster也作为对象记录下来，并当成普通User来处理。发送的时候，所有发往同一AI服务器的消息只发送1次，这样AI服务器就会获得各种移动攻击等消息的同步，接下来，你在AI服务器上做逻辑判断后，将攻击/移动等操作通过消息发往游戏服务器/场景服务器处理即可。但需要做逻辑合并处理。


##A*寻路

必须得寻路，先用dda直线算法，直线寻路又叫视线寻路，如果中间有障碍再用a*

##任务调度


##全服组队，全服交易

需要单独进程或线程处理，由RPC来配合通信


##聊天，通知系统，跨服邮件
可以考虑消息中心：发布者-订阅者（Publisher-Subscriber）的设计思路。
组队聊天，公会聊天，世界聊天，全服大喇叭

需要单独进程或线程处理，由RPC来配合通信


##新手村拥堵
新手村问题：《天龙八部》提出了较好的解决方案，建立多个平行的新手村地图，一主多副，开服时尽可能多的同时容纳新用户的涌入，高等级玩家从其它地图回新手村只能到达主新手村。
类似于场景的分线处理。



##服务器状态：
0：未开启 【前端不能进入】
1：繁忙
2：良好
3：空闲
4：维护中 【前端不能进入】
5：提前录入，前端不能显示出来


##背包：

我们希望可以追踪每件可能被交易的物品，每件物品都有 64bit 的唯一 id 。在背包格里可以叠加若干件相同物品，但是每件物品都有单独 id 。这个 id 是用于最终和拥有者校验用的，不必传输给客户端，在交易系统外也不需要被读取。

物品是以 lua 对象的形式保存在内存中的，不同类别的物品有不同的方法可以获得物品的不同属性。

玩家制造的装备，需要记录下装备制造者的名字。或是有用宝石强化过的装备，需要记录强化信息。


背包有几个基本操作：
```
QUERY：查询一个物品格里的物品对象和数量。
TRADEOUT ：把一个物品格里的所有物品都拿出来。生成一个交易单。这个 API 主要是把物品从背包里抹掉，如果物品格对仓库有引用，也同时抹掉。返回的交易单是一组纯数据，里面有物品的序列化信息，以及所有的物品唯一 id 。
TRADEIN ：把一个交易单里提到的所有物品，合并到一个物品格里。这个是 TRADEOUT 的逆操作。
EXCHANGE ：交换两个物品格。
SPLIT ：把一个物品格内的多件物品分割成两份，放在新的格子中。
CONSUME ：消耗掉一个物品格中的若干件物品。
```




##others
好游戏 = 能吸量 + 高留存 + 能坑人（吸人留人吸金）

###2D类游戏立项

* 传奇类
* 策略类：帝王三国1/2, 大皇帝(战棋类)，一统天下，王者之域
	日系美女版三国 ？
	王者天下，战国 ？
	爆笑三国，单机游戏 ?
	
	
* 大航海时代5
* 挂机类
* 街机类游戏：合金弹头，拳皇，三国志，三国战记，雷电，四国战机
【时空猎人】


###如何吸量
吸量的问题，主要是从几方面着手:
	第一个是题材，
	第二游戏类型，
	第三个就是IP，
	还有就是美术这块，日系(胧村正,剑无生)，韩系(七骑士)，国风(影之刃)，


题材选择：
!!!! 游戏&体育：粉丝转化率较高，【仙剑，魔兽，刀塔，传奇，街机，武侠】
!!! 日漫&美漫：粉丝转化率较高，【海贼王，火忍，超级英雄  【盗版多】】
!!! 国产漫画：粉丝转化率较高，【秦时明月】
!! 网络文学：粉丝转化率适中，【唐家三少，西红柿】
! 电影&电视剧：粉丝转化率较低，【冰雪奇缘】
! 自制剧&综艺节目：粉丝转化率较低，【爸爸去哪儿】


考查点：包大小，流畅度，复杂度(做减法)，深度



###留存

* 第一次加载加载时间
* 游戏连续登陆送元宝。
* 七日冲级送实物大奖。送Iphone5S或者其他的产品让用户留存。或者第七日就送名人，熬到第七日送一个五星卡牌。
* 新服第一届帮战在开服第三天开启，让玩家有短期的目标去追求。
* 半个月出小玩法，新卡牌，一个月出新功能、新目标，让玩家有兴趣。

这是运营可以干预留存用户的手段，也是核心之一。

在具体的游戏研发过程中，制作人必须直接关注美术设计。王峰更是直言：“丑是不可被原谅的，用户大部分看第一感觉。”


###产品生命周期
游戏类型


###渠道属性：
* 同步推用户属性会偏Q版，偏日系风格，喜欢比较萌的，可爱风格的游戏。

* 九游公会
九游公会：九游紫轩阁
九游代理的游戏：弹弹堂，醉西游，狂撸忍者村，新三国争霸



深度解析移动游戏运营的五个核心 http://www.sykong.com/2014/06/22578
【产品预热】在整个运营过程中，起着重要的作用，手游预热是让市场、让用户感觉产品的存在，为以后发力蓄势。预热又可以细分为以下的几个渠道：

（1）媒体专区预热，作为产品曝光的先锋，媒体预热，是作为产品运营的一个核心，手游媒体作为大量手游用户的聚集地。（媒体预热手段有新闻、礼包、攻略，屌丝用户很喜欢研究这些攻略的、活动，跟媒体专区做一些送充值卡等系列活动、视频，产品曝光视频，增加产品市场热度），所以预热也是考验运营的一个核心。

（2）渠道“新游期待榜”名次。通过论坛“踩楼”、“签到”等预热活动，提升论坛热度，从而达到冲榜目的。

（3）微信公众号预热。微信预热是手游运营一种新的方式，因为这个比起媒体灵活更高，我们可以和用户形成交互。公众号的预热，我们会选择发红包、发礼包和抽奖的形式，让关注我们公众号的用户提前了解产品预热的过程。


《洪荒OL》交出了一张漂亮的成绩单S级产品，次留58%，平均付费4.7%，平均arpu3.36。

###策划大模块
成长系统：目标控制，成长曲线
策略玩法：任务基本属性，技能，战斗
经济系统：和成长系统密切挂钩
社交系统：公会，阵营


细节：组队双倍奖励


策划应该这样：
“这些豪华的人冥思苦想了许久，终于得到了一个相对靠谱的答案：游戏还是不能脱离根本的乐趣，而这个乐趣，恰恰是与想法和创意密切相关的东西。那么这个跟最底层的有何区别呢？这些绝顶豪华的策划，往往也需要花费十来天的时间，琢磨数十种想法与创意，推敲其中无数的细节，最终落定数个方案，再花费十来天的时间对这些方案挑选和打磨，最终拿出的也许只是一个普通策划眼里，半天即可完成的山寨策划方案；最重要的是，【他们始终立足于游戏整体蓝图，去思考最细节的点】；而不是先完成局部，去拼凑一个未知的整体。当然，每个第四层的策划都是各不相同的，因为他们悟出的游戏本质都有各自的角度（即乐趣在不同玩家群中的不同表现形式），这些独特的视角，却已足够支持每个他们称霸一方了。”


